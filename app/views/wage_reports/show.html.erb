
<div class="card">
  <div class="card-header" id= "card-header">Wage Report Overview for <%="#{@organization.legal_name.capitalize}"%> - <%=@report.timespans.first.title%></div>
    <div class = "card-body">
      <div class = "card">
        <div class="accordion md-accordion" id="accordionEx" role="tablist" >
          <div class="card-header" role="tab">
            <a data-toggle="collapse" data-parent="#accordionEx" href="#details">
              <li class="list-group-item">Wage Report Details</li>
            </a>
            </div>
              <div id="details" class="card-body collapse hide">
                <div class="card">
                <table class="table table-striped">
                  <tbody>
                    <tr>
                      <td>Begin Date</td>
                      <td ><%=@report.timespans.first.begin_on%></td>
                    </tr>
                    <tr>
                      <td>End Date</td>
                      <td><%=@report.timespans.first.end_on%></td>
                    </tr>
                    <tr>
                      <td class="card-header">Submitted At</td>
                      <td ><%=@report.submitted_at%></td>
                    </tr>
                    <tr>
                      <td class="card-header">Status</td>
                      <td ><%=@report.status.capitalize%></td>
                    </tr>
                    <tr>
                      <td class="card-header">Submission Kind</td>
                      <td ><%=@report.submission_kind.capitalize%></td>
                    </tr>
                    <tr>
                      <td  class="card-header">Total State Gross Wages</td>
                      <td > $<%=@report.state_total_gross_wages%></td>
                    </tr>
                    <tr>
                      <td class="card-header">Total State UI Wages</td>
                      <td>$<%=@report.state_ui_total_wages%></td>
                    </tr>
                    <tr>
                      <td class="card-header"> State UI Taxable Wages</td>
                      <td>$<%=@report.state_ui_taxable_wages%></td>
                    </tr>
                    <tr>
                      <td class="card-header"> State UI Excess Wages</td>
                      <td>$<%=@report.state_ui_excess_wages%></td>
                    </tr>
                  </tbody>
                </table>
             </div>
          </div>
        </div>
      </div>
    </div>
  <div class="card-body">
    <div class="card">
      <div class="accordion md-accordion" id="accordionEx" role="tablist" >
        <div class="card-header" role="tab">
          <a data-toggle="collapse" data-parent="#accordionEx" href="#entries">
            <li class="list-group-item">Wage Entries </li>
          </a>
        </div>
      <div id="entries" class="card-body collapse hide">
        <div class="accordion md-accordion" id="accordionEx" role="tablist" >
          <div class="card-header" role="tab">
          <a data-toggle="collapse" data-parent="#accordionEx" href="#new-entry-table">
            <button id="plus" class="btn btn-outline-primary btn-rounded ">+</button>
          </a>
          </div>
        </div>
        <div id= "new-entry-table" class="card-body collapse hide">
        <div class="accordion md-accordion" id="accordionEx" role="tablist" >
            <%= form_for @report, url: wage_report_path(@report), method: :put do |f| %>
              <%= f.fields_for :wage do |field| %>
              <div class="row">
              <div class="col">
              <%= select_tag 'people', options_for_select(@people.collect{ |u|[ u.current_first_name, u.id ] }.unshift("Choose Employee")), :class =>" input form-control"%>
              </div>
                <div class="col">
                <%= field.number_field :state_total_gross_wages, placeholder:"Total Gross Wages", :class =>" input form-control" %>
                </div>
                <div class="col">
                  <%= field.number_field :state_total_wages, placeholder:" State Total Wages",  :class =>"input  form-control" %>
                </div>
                <div class="col">
               <%= field.number_field :state_excess_wages, placeholder:"State Excess Wages",  :class =>"input  form-control" %>
               </div>
               <div class="col">
                <%= field.number_field :state_taxable_wages, placeholder:"State Taxable Wages",  :class =>"input  form-control" %>
                </div>
                <% end %>
              <%= f.submit 'Add Entry', :class =>"btn btn-outline-primary btn-rounded input " %>
            <% end %>
          </div>
        </div>
    </div>
      <table class="table table-striped ">
      <thead>
      <tr>
      <th class="th-sm">Employee</th>
      <th class="th-sm">Submission Kind</th>
      <th class="th-sm">Submitted At</th>
      <th class="th-sm">Total Gross Wages</th>
      <th class="th-sm">Total Wages</th>
      <th class="th-sm">Excess Wages</th>
      <th class="th-sm">Taxable Wages</th>
    </tr>
      </thead>
          <tbody>
          <% @entries.each do |entry| %>
            <tr>
              <td><%= entry.try(:wage).try(:person_party).try(:current_first_name)%></td>
              <td scope="row"><%= entry.submission_kind.capitalize%></td>
              <td scope="row"><%= entry.submitted_at%></td>

              <td>$ <%= entry.try(:wage).try(:state_total_gross_wages)%></td>
              <td>$ <%= entry.try(:wage).try(:state_total_wages)%></td>
              <td>$ <%= entry.try(:wage).try(:state_excess_wages)%></td>
              <td>$ <%= entry.try(:wage).try(:state_taxable_wages)%></td>


            </tr>
          <%end%>
          </tbody>
        </table>
      </div>
    </div>
  </div>
  </div>
</div>
